---
kind: Module
name: operator-build-image
description: Operator build
type: container
include:
  - pkg
  - internal
  - controllers
  - apis
  - main.go
  - go.*
  - Dockerfile
---
kind: Module
description: Update operator version
type: exec
name: operator-build-manifest
include:
  - config
build:
  command:
    - >
      cd config/manager &&
      kustomize edit set image controller=operator-build-image:${modules.operator-build-image.version}
disabled: true
---
kind: Module
type: kubernetes
name: operator
include:
  - config
kustomize:
  path: config/default
dependencies:
  - cert-manager
build:
  dependencies:
    - name: operator-build-image
    - name: operator-build-manifest
      copy:
        - source: config
          target: config